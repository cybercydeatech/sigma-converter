author: Moti Harmats
date: 2023/02/11
description: 'Detects potential OGNL Injection exploitation, which may lead to RCE.

  OGNL is an expression language that is supported in many JVM based systems.

  OGNL Injection is the reason for some high profile RCE''s such as Apache Struts
  (CVE-2017-5638) and Confluence (CVE-2022-26134)

  '
detection:
  condition: keywords
  keywords:
  - org.apache.commons.ognl.OgnlException
  - ExpressionSyntaxException
falsepositives:
- Application bugs
id: 4d0af518-828e-4a04-a751-a7d03f3046ad
level: high
logsource:
  category: application
  definition: 'Requirements: application error logs must be collected (with LOG_LEVEL=ERROR
    and above)'
  product: jvm
references:
- https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs
status: test
tags:
- attack.initial_access
- attack.t1190
- cve.2017.5638
- cve.2022.26134
title: Potential OGNL Injection Exploitation In JVM Based Application
