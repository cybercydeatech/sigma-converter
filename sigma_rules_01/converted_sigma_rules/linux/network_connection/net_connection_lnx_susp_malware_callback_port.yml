author: hasselj
date: 2024/05/10
description: 'Detects programs that connect to known malware callback ports based
  on threat intelligence reports.

  '
detection:
  condition: selection and not 1 of filter_main_*
  filter_main_local_ranges:
    DestinationIp|cidr:
    - 127.0.0.0/8
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
    - 169.254.0.0/16
    - ::1/128
    - fe80::/10
    - fc00::/7
  selection:
    DestinationPort:
    - 888
    - 999
    - 2200
    - 2222
    - 4000
    - 4444
    - 6789
    - 8531
    - 50501
    - 51820
    Initiated: 'true'
falsepositives:
- Unknown
id: dbfc7c98-04ab-4ab7-aa94-c74d22aa7376
level: high
logsource:
  category: network_connection
  product: linux
references:
- https://www.mandiant.com/resources/blog/triton-actor-ttp-profile-custom-attack-tools-detections
- https://www.mandiant.com/resources/blog/ukraine-and-sandworm-team
- https://www.elastic.co/guide/en/security/current/potential-non-standard-port-ssh-connection.html
- https://thehackernews.com/2024/01/systembc-malwares-c2-server-analysis.html
- https://www.cybereason.com/blog/sliver-c2-leveraged-by-many-threat-actors
related:
- id: 4b89abaa-99fe-4232-afdd-8f9aa4d20382
  type: derived
status: experimental
tags:
- attack.persistence
- attack.command_and_control
- attack.t1571
title: Potentially Suspicious Malware Callback Communication - Linux
