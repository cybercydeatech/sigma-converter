author: Florian Roth (Nextron Systems)
date: 2017/03/19
description: Detects programs that connect to uncommon destination ports
detection:
  condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_local_ranges:
    DestinationIp|cidr:
    - 127.0.0.0/8
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
    - 169.254.0.0/16
    - ::1/128
    - fe80::/10
    - fc00::/7
  filter_optional_sys_directories:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  selection:
    DestinationPort:
    - 8080
    - 8888
    Initiated: 'true'
falsepositives:
- Unknown
id: 6d8c3d20-a5e1-494f-8412-4571d716cf5c
level: medium
logsource:
  category: network_connection
  product: windows
modified: 2024/03/12
references:
- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
related:
- id: 4b89abaa-99fe-4232-afdd-8f9aa4d20382
  type: similar
status: test
tags:
- attack.persistence
- attack.command_and_control
- attack.t1571
title: Communication To Uncommon Destination Ports
