alert:
- debug
description: Identifies when ClusterRoles/Roles are being modified or deleted.
filter:
- query:
    query_string:
      query: 
        operationName:("MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/WRITE"
        OR 
        "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/DELETE"
        OR 
        "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/BIND\/ACTION"
        OR 
        "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/ESCALATE\/ACTION"
        OR 
        "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/WRITE"
        OR 
        "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/DELETE"
        OR 
        "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/BIND\/ACTION"
        OR 
        "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/ESCALATE\/ACTION")
index: wazuh-alerts*
name: azure_kubernetes_role_access
priority: 3
realert:
  minutes: 0
type: any

is_enabled: true
timestamp_type: iso
timestamp_field: '@timestamp'
